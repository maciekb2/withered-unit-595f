---
import { SITE_TITLE } from '../consts';
import Menu from './Menu.astro';
---

<header>
        <nav>
                <a href="/" class="logo">
                        <img src="/pseudointelekt_logo_tekstura.svg" alt={SITE_TITLE} width="40" height="40" />
                </a>
                <Menu />
        </nav>
</header>
<script>
        const header = document.querySelector('header');
        let lastScroll = window.scrollY;
        window.addEventListener('scroll', () => {
                const current = window.scrollY;
                if (current > lastScroll && current > header.offsetHeight) {
                        header.classList.add('hidden');
                } else {
                        header.classList.remove('hidden');
                }
                lastScroll = current;
        });
        header.addEventListener('mousemove', (e) => {
                const rect = header.getBoundingClientRect();
                const x = e.clientX - rect.left - rect.width / 2;
                const y = e.clientY - rect.top - rect.height / 2;
                const rotateX = (y / rect.height) * 8;
                const rotateY = -(x / rect.width) * 8;
                header.style.setProperty('--rotate-x', `${rotateX}deg`);
                header.style.setProperty('--rotate-y', `${rotateY}deg`);
        });
        header.addEventListener('mouseleave', () => {
                header.style.setProperty('--rotate-x', `0deg`);
                header.style.setProperty('--rotate-y', `0deg`);
        });
</script>
<style>
        header {
                margin: 0;
                padding: 0 1em;
                background: white;
                box-shadow: 0 2px 8px rgba(var(--black), 5%);
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                z-index: 10;
                transition: top 0.3s ease, transform 0.2s ease;
                transform: perspective(600px) rotateX(var(--rotate-x, 0)) rotateY(var(--rotate-y, 0));
        }
        header.hidden {
                top: -100%;
        }
        .logo {
                display: flex;
                align-items: center;
        }
        .logo img {
                display: block;
        }
        nav {
                display: flex;
                align-items: center;
                justify-content: space-between;
                perspective: 600px;
        }
        nav a {
                position: relative;
                padding: 1em 0.75em;
                color: var(--black);
                text-decoration: none;
                transition: color 0.3s, transform 0.2s;
        }
        nav a:hover {
                color: var(--accent);
                box-shadow: inset 0 0 0 2px var(--accent);
                transform: translateZ(5px);
        }
        nav a.active {
                text-decoration: none;
                box-shadow: inset 0 0 0 2px var(--accent);
        }

</style>
